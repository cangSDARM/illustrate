{"mappings":"A,C,E,A,A,W,iB,C,Q,A,E,Q,S,C,C,C,ECAA,EAAA,OAAA,CAAiB,KAAK,KAAK,CAAC,+hI","sources":["<anon>","src/QUIC/serverApplicationKeysCalc.json"],"sourcesContent":["\n      var $parcel$global = globalThis;\n    var parcelRequire = $parcel$global[\"parcelRequire7f38\"];\nvar parcelRegister = parcelRequire.register;\nparcelRegister(\"6uCMp\", function(module, exports) {\nmodule.exports = JSON.parse('[\"\\u670D\\u52A1\\u5668\\u7AEF\\u73B0\\u5728\\u53EF\\u4EE5\\u8BA1\\u7B97\\u5E94\\u7528\\u4F1A\\u8BDD\\u65F6\\u7684\\u5BC6\\u94A5\\u4E86\\u3002\\u5728\\u8FD9\\u4E2A\\u8BA1\\u7B97\\u4E2D\\uFF0C\\u670D\\u52A1\\u5668\\u4F7F\\u7528\\u4E86\\u4EE5\\u4E0B\\u4FE1\\u606F\\uFF1A\",{\"Tag\":\"ul\",\"children\":[{\"Tag\":\"li\",\"content\":\"\\u670D\\u52A1\\u5668\\u7AEF\\u5BC6\\u6587(\\u4E4B\\u524D\\u51C6\\u5907\\u63E1\\u624B\\u5BC6\\u94A5\\u65F6\\u751F\\u6210)\"},{\"Tag\":\"li\",\"content\":\"ClientHello \\u5230 \\u670D\\u52A1\\u5668\\u63E1\\u624B\\u7ED3\\u675F \\u6240\\u6709\\u63E1\\u624B\\u65F6\\u5305\\u7684 SHA256 \\u54C8\\u5E0C\\u503C(\\u6563\\u5217\\u8F93\\u5165\\u4E0D\\u5305\\u62ECQUIC\\u5E27\\u5934)\"}]},\"32 \\u5B57\\u8282\\u7684 \\\\\"handshake_hash\\\\\" \\u6700\\u7EC8\\u503C\\u662F\\uFF1A\",{\"Tag\":\"pre\",\"props\":{\"className\":\"ind2\"},\"children\":[{\"Tag\":\"code\",\"props\":{\"className\":\"longboi\"},\"content\":\"b965185af5034eda0ea13ab424dde193afcb42451823a96921ae9d2dad9594ef\"}]},{\"Tag\":\"CodeSample\",\"props\":{\"code\":\"$ cat crypto_clienthello crypto_serverhello crypto_extensions   crypto_cert crypto_certverify crypto_s_finished  | openssl sha256\\\\n\\\\nb965185af5034eda0ea13ab424dde193afcb42451823a96921ae9d2dad9594ef\"}},\"\\u7136\\u540E\\uFF0C\\u6211\\u4EEC\\u5C06\\u54C8\\u5E0C\\u503C\\u548C\\u5171\\u4EAB\\u7684\\u7B7E\\u540D\\u4FE1\\u606F\\u8FDB\\u884C\\u4E00\\u4E9B\\u5BC6\\u94A5\\u6D3E\\u751F\\u64CD\\u4F5C(key derivation operations)\\uFF0C\\u4EE5\\u9632\\u6B62\\u53EF\\u80FD\\u7684\\u653B\\u51FB\\uFF1A\",{\"Tag\":\"pre\",\"children\":[{\"Tag\":\"code\",\"props\":{\"className\":\"longboi\"},\"content\":\"empty_hash = SHA256(\\\\\"\\\\\")\\\\nderived_secret = HKDF-Expand-Label(key: handshake_secret, label: \\\\\"derived\\\\\", ctx: empty_hash, len: 32)\\\\nmaster_secret = HKDF-Extract(salt: derived_secret, key: 00...)\\\\nclient_secret = HKDF-Expand-Label(key: master_secret, label: \\\\\"c ap traffic\\\\\", ctx: handshake_hash, len: 32)\\\\nserver_secret = HKDF-Expand-Label(key: master_secret, label: \\\\\"s ap traffic\\\\\", ctx: handshake_hash, len: 32)\\\\nclient_key = HKDF-Expand-Label(key: client_secret, label: \\\\\"quic key\\\\\", ctx: \\\\\"\\\\\", len: 16)\\\\nserver_key = HKDF-Expand-Label(key: server_secret, label: \\\\\"quic key\\\\\", ctx: \\\\\"\\\\\", len: 16)\\\\nclient_iv = HKDF-Expand-Label(key: client_secret, label: \\\\\"quic iv\\\\\", ctx: \\\\\"\\\\\", len: 12)\\\\nserver_iv = HKDF-Expand-Label(key: server_secret, label: \\\\\"quic iv\\\\\", ctx: \\\\\"\\\\\", len: 12)\\\\nclient_hp_key = HKDF-Expand-Label(key: client_secret, label: \\\\\"quic hp\\\\\", ctx: \\\\\"\\\\\", len: 16)\\\\nserver_hp_key = HKDF-Expand-Label(key: server_secret, label: \\\\\"quic hp\\\\\", ctx: \\\\\"\\\\\", len: 16)\"}]},{\"children\":[\"\\u5728\\u547D\\u4EE4\\u884C\\u4E2D\\u4F7F\\u7528\",{\"Tag\":\"a\",\"props\":{\"href\":\"https://quic.xargs.org/files/hkdf.sh\"},\"content\":\"\\u539F\\u4F5C\\u8005\\u5236\\u4F5C\\u7684 HKDF \\u547D\\u4EE4\\u884C\\u811A\\u672C\"},\"\\uFF0C\\u4F60\\u4E5F\\u53EF\\u4EE5\\u81EA\\u5DF1\\u8BD5\\u8BD5\\uFF1A\"]},{\"Tag\":\"CodeSample\",\"props\":{\"code\":\"$ handshake_hash=b965185af5034eda0ea13ab424dde193afcb42451823a96921ae9d2dad9594ef\\\\n$ handshake_secret=fb9fc80689b3a5d02c33243bf69a1b1b20705588a794304a6e7120155edf149a\\\\n$ zero_key=0000000000000000000000000000000000000000000000000000000000000000\\\\n$ empty_hash=$(openssl sha256 < /dev/null | sed -e \\'s/.* //\\')\\\\n$ derived_secret=$(./hkdf expandlabel $handshake_secret \\\\\"derived\\\\\" $empty_hash 32)\\\\n$ master_secret=$(./hkdf extract $derived_secret $zero_key)\\\\n$ csecret=$(./hkdf expandlabel $master_secret \\\\\"c ap traffic\\\\\" $handshake_hash 32)\\\\n$ ssecret=$(./hkdf expandlabel $master_secret \\\\\"s ap traffic\\\\\" $handshake_hash 32)\\\\n$ client_data_key=$(./hkdf expandlabel $csecret \\\\\"quic key\\\\\" \\\\\"\\\\\" 16)\\\\n$ server_data_key=$(./hkdf expandlabel $ssecret \\\\\"quic key\\\\\" \\\\\"\\\\\" 16)\\\\n$ client_data_iv=$(./hkdf expandlabel $csecret \\\\\"quic iv\\\\\" \\\\\"\\\\\" 12)\\\\n$ server_data_iv=$(./hkdf expandlabel $ssecret \\\\\"quic iv\\\\\" \\\\\"\\\\\" 12)\\\\n$ client_data_hp=$(./hkdf expandlabel $csecret \\\\\"quic hp\\\\\" \\\\\"\\\\\" 16)\\\\n$ server_data_hp=$(./hkdf expandlabel $ssecret \\\\\"quic hp\\\\\" \\\\\"\\\\\" 16)\\\\n$ echo skey: $server_data_key\\\\n$ echo siv: $server_data_iv\\\\n$ echo shp: $server_data_hp\\\\n$ echo ckey: $client_data_key\\\\n$ echo civ: $client_data_iv\\\\n$ echo chp: $client_data_hp\\\\n\\\\nskey: fd8c7da9de1b2da4d2ef9fd5188922d0\\\\nsiv: 02f6180e4f4aa456d7e8a602\\\\nshp: b7f6f021453e52b58940e4bba72a35d4\\\\nckey: e010a295f0c2864f186b2a7e8fdc9ed7\\\\nciv: eb3fbc384a3199dcf6b4c808\\\\nchp: 8a6a38bc5cc40cb482a254dac68c9d2f\"}},\"\\u7531\\u6B64\\u6211\\u4EEC\\u53EF\\u4EE5\\u5F97\\u5230\\u4EE5\\u4E0B\\u5BC6\\u94A5\\u4EE5\\u53CA\\u5411\\u91CF\\uFF1A\",{\"Tag\":\"ul\",\"children\":[{\"Tag\":\"li\",\"children\":[\"\\u5BA2\\u6237\\u7AEF\\u4F1A\\u8BDD\\u5BC6\\u94A5: \",{\"Tag\":\"code\",\"content\":\"e010a295f0c2864f186b2a7e8fdc9ed7\"}]},{\"Tag\":\"li\",\"children\":[\"\\u5BA2\\u6237\\u7AEF\\u4F1A\\u8BDD\\u5411\\u91CF: \",{\"Tag\":\"code\",\"content\":\"eb3fbc384a3199dcf6b4c808\"}]},{\"Tag\":\"li\",\"children\":[\"\\u5BA2\\u6237\\u7AEF\\u4F1A\\u8BDD\\u6570\\u636E\\u5305\\u5934\\u4FDD\\u62A4\\u5BC6\\u94A5: \",{\"Tag\":\"code\",\"content\":\"8a6a38bc5cc40cb482a254dac68c9d2f\"}]},{\"Tag\":\"li\",\"children\":[\"\\u670D\\u52A1\\u5668\\u7AEF\\u4F1A\\u8BDD\\u5BC6\\u94A5: \",{\"Tag\":\"code\",\"content\":\"fd8c7da9de1b2da4d2ef9fd5188922d0\"}]},{\"Tag\":\"li\",\"children\":[\"\\u670D\\u52A1\\u5668\\u7AEF\\u4F1A\\u8BDD\\u5411\\u91CF: \",{\"Tag\":\"code\",\"content\":\"02f6180e4f4aa456d7e8a602\"}]},{\"Tag\":\"li\",\"children\":[\"\\u670D\\u52A1\\u5668\\u7AEF\\u4F1A\\u8BDD\\u6570\\u636E\\u5305\\u5934\\u4FDD\\u62A4\\u5BC6\\u94A5: \",{\"Tag\":\"code\",\"content\":\"b7f6f021453e52b58940e4bba72a35d4\"}]}]}]');\n\n});\n\n\n//# sourceMappingURL=serverApplicationKeysCalc.23686666.js.map\n","[\n  \"服务器端现在可以计算应用会话时的密钥了。在这个计算中，服务器使用了以下信息：\",\n  {\n    \"Tag\": \"ul\",\n    \"children\": [\n      {\n        \"Tag\": \"li\",\n        \"content\": \"服务器端密文(之前准备握手密钥时生成)\"\n      },\n      {\n        \"Tag\": \"li\",\n        \"content\": \"ClientHello 到 服务器握手结束 所有握手时包的 SHA256 哈希值(散列输入不包括QUIC帧头)\"\n      }\n    ]\n  },\n  \"32 字节的 \\\"handshake_hash\\\" 最终值是：\",\n  {\n    \"Tag\": \"pre\",\n    \"props\": {\n      \"className\": \"ind2\"\n    },\n    \"children\": [\n      {\n        \"Tag\": \"code\",\n        \"props\": { \"className\": \"longboi\" },\n        \"content\": \"b965185af5034eda0ea13ab424dde193afcb42451823a96921ae9d2dad9594ef\"\n      }\n    ]\n  },\n  {\n    \"Tag\": \"CodeSample\",\n    \"props\": {\n      \"code\": \"$ cat crypto_clienthello crypto_serverhello crypto_extensions   crypto_cert crypto_certverify crypto_s_finished  | openssl sha256\\n\\nb965185af5034eda0ea13ab424dde193afcb42451823a96921ae9d2dad9594ef\"\n    }\n  },\n  \"然后，我们将哈希值和共享的签名信息进行一些密钥派生操作(key derivation operations)，以防止可能的攻击：\",\n  {\n    \"Tag\": \"pre\",\n    \"children\": [\n      {\n        \"Tag\": \"code\",\n        \"props\": { \"className\": \"longboi\" },\n        \"content\": \"empty_hash = SHA256(\\\"\\\")\\nderived_secret = HKDF-Expand-Label(key: handshake_secret, label: \\\"derived\\\", ctx: empty_hash, len: 32)\\nmaster_secret = HKDF-Extract(salt: derived_secret, key: 00...)\\nclient_secret = HKDF-Expand-Label(key: master_secret, label: \\\"c ap traffic\\\", ctx: handshake_hash, len: 32)\\nserver_secret = HKDF-Expand-Label(key: master_secret, label: \\\"s ap traffic\\\", ctx: handshake_hash, len: 32)\\nclient_key = HKDF-Expand-Label(key: client_secret, label: \\\"quic key\\\", ctx: \\\"\\\", len: 16)\\nserver_key = HKDF-Expand-Label(key: server_secret, label: \\\"quic key\\\", ctx: \\\"\\\", len: 16)\\nclient_iv = HKDF-Expand-Label(key: client_secret, label: \\\"quic iv\\\", ctx: \\\"\\\", len: 12)\\nserver_iv = HKDF-Expand-Label(key: server_secret, label: \\\"quic iv\\\", ctx: \\\"\\\", len: 12)\\nclient_hp_key = HKDF-Expand-Label(key: client_secret, label: \\\"quic hp\\\", ctx: \\\"\\\", len: 16)\\nserver_hp_key = HKDF-Expand-Label(key: server_secret, label: \\\"quic hp\\\", ctx: \\\"\\\", len: 16)\"\n      }\n    ]\n  },\n  {\n    \"children\": [\n      \"在命令行中使用\",\n      {\n        \"Tag\": \"a\",\n        \"props\": { \"href\": \"https://quic.xargs.org/files/hkdf.sh\" },\n        \"content\": \"原作者制作的 HKDF 命令行脚本\"\n      },\n      \"，你也可以自己试试：\"\n    ]\n  },\n  {\n    \"Tag\": \"CodeSample\",\n    \"props\": {\n      \"code\": \"$ handshake_hash=b965185af5034eda0ea13ab424dde193afcb42451823a96921ae9d2dad9594ef\\n$ handshake_secret=fb9fc80689b3a5d02c33243bf69a1b1b20705588a794304a6e7120155edf149a\\n$ zero_key=0000000000000000000000000000000000000000000000000000000000000000\\n$ empty_hash=$(openssl sha256 < /dev/null | sed -e 's/.* //')\\n$ derived_secret=$(./hkdf expandlabel $handshake_secret \\\"derived\\\" $empty_hash 32)\\n$ master_secret=$(./hkdf extract $derived_secret $zero_key)\\n$ csecret=$(./hkdf expandlabel $master_secret \\\"c ap traffic\\\" $handshake_hash 32)\\n$ ssecret=$(./hkdf expandlabel $master_secret \\\"s ap traffic\\\" $handshake_hash 32)\\n$ client_data_key=$(./hkdf expandlabel $csecret \\\"quic key\\\" \\\"\\\" 16)\\n$ server_data_key=$(./hkdf expandlabel $ssecret \\\"quic key\\\" \\\"\\\" 16)\\n$ client_data_iv=$(./hkdf expandlabel $csecret \\\"quic iv\\\" \\\"\\\" 12)\\n$ server_data_iv=$(./hkdf expandlabel $ssecret \\\"quic iv\\\" \\\"\\\" 12)\\n$ client_data_hp=$(./hkdf expandlabel $csecret \\\"quic hp\\\" \\\"\\\" 16)\\n$ server_data_hp=$(./hkdf expandlabel $ssecret \\\"quic hp\\\" \\\"\\\" 16)\\n$ echo skey: $server_data_key\\n$ echo siv: $server_data_iv\\n$ echo shp: $server_data_hp\\n$ echo ckey: $client_data_key\\n$ echo civ: $client_data_iv\\n$ echo chp: $client_data_hp\\n\\nskey: fd8c7da9de1b2da4d2ef9fd5188922d0\\nsiv: 02f6180e4f4aa456d7e8a602\\nshp: b7f6f021453e52b58940e4bba72a35d4\\nckey: e010a295f0c2864f186b2a7e8fdc9ed7\\nciv: eb3fbc384a3199dcf6b4c808\\nchp: 8a6a38bc5cc40cb482a254dac68c9d2f\"\n    }\n  },\n  \"由此我们可以得到以下密钥以及向量：\",\n  {\n    \"Tag\": \"ul\",\n    \"children\": [\n      {\n        \"Tag\": \"li\",\n        \"children\": [\n          \"客户端会话密钥: \",\n          {\n            \"Tag\": \"code\",\n            \"content\": \"e010a295f0c2864f186b2a7e8fdc9ed7\"\n          }\n        ]\n      },\n      {\n        \"Tag\": \"li\",\n        \"children\": [\n          \"客户端会话向量: \",\n          {\n            \"Tag\": \"code\",\n            \"content\": \"eb3fbc384a3199dcf6b4c808\"\n          }\n        ]\n      },\n      {\n        \"Tag\": \"li\",\n        \"children\": [\n          \"客户端会话数据包头保护密钥: \",\n          {\n            \"Tag\": \"code\",\n            \"content\": \"8a6a38bc5cc40cb482a254dac68c9d2f\"\n          }\n        ]\n      },\n      {\n        \"Tag\": \"li\",\n        \"children\": [\n          \"服务器端会话密钥: \",\n          {\n            \"Tag\": \"code\",\n            \"content\": \"fd8c7da9de1b2da4d2ef9fd5188922d0\"\n          }\n        ]\n      },\n      {\n        \"Tag\": \"li\",\n        \"children\": [\n          \"服务器端会话向量: \",\n          {\n            \"Tag\": \"code\",\n            \"content\": \"02f6180e4f4aa456d7e8a602\"\n          }\n        ]\n      },\n      {\n        \"Tag\": \"li\",\n        \"children\": [\n          \"服务器端会话数据包头保护密钥: \",\n          {\n            \"Tag\": \"code\",\n            \"content\": \"b7f6f021453e52b58940e4bba72a35d4\"\n          }\n        ]\n      }\n    ]\n  }\n]\n"],"names":["parcelRequire","$parcel$global","globalThis","register","module","exports","JSON","parse"],"version":3,"file":"serverApplicationKeysCalc.23686666.js.map"}