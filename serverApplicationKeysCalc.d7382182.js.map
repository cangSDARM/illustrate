{"mappings":"A,C,E,A,A,W,iB,C,Q,A,E,Q,S,C,C,C,ECAA,EAAA,OAAA,CAAiB,KAAK,KAAK,CAAC,koI","sources":["<anon>","src/TLS13/serverApplicationKeysCalc.json"],"sourcesContent":["\n      var $parcel$global = globalThis;\n    var parcelRequire = $parcel$global[\"parcelRequire7f38\"];\nvar parcelRegister = parcelRequire.register;\nparcelRegister(\"9Aq7U\", function(module, exports) {\nmodule.exports = JSON.parse('[\"\\u670D\\u52A1\\u5668\\u7AEF\\u73B0\\u5728\\u53EF\\u4EE5\\u8BA1\\u7B97\\u5E94\\u7528\\u4F1A\\u8BDD\\u65F6\\u7684\\u5BC6\\u94A5\\u4E86\\u3002\\u5728\\u8FD9\\u4E2A\\u8BA1\\u7B97\\u4E2D\\uFF0C\\u670D\\u52A1\\u5668\\u4F7F\\u7528\\u4E86\\u4EE5\\u4E0B\\u4FE1\\u606F\\uFF1A\",{\"Tag\":\"ul\",\"children\":[{\"Tag\":\"li\",\"content\":\"\\u670D\\u52A1\\u5668\\u7AEF\\u5BC6\\u6587(\\u4E4B\\u524D\\u51C6\\u5907\\u63E1\\u624B\\u5BC6\\u94A5\\u65F6\\u751F\\u6210)\"},{\"Tag\":\"li\",\"content\":\"ClientHello \\u5230 \\u670D\\u52A1\\u5668\\u63E1\\u624B\\u7ED3\\u675F \\u6240\\u6709\\u63E1\\u624B\\u65F6\\u5305\\u7684 SHA256 \\u54C8\\u5E0C\\u503C\"}]},\"\\u8FD9\\u4E2A\\u54C8\\u5E0C\\u503C\\u5305\\u62EC\\uFF1AClientHello\\u3001ServerHello\\u3001[\\u672A\\u4F2A\\u88C5\\u90E8\\u5206]\\u989D\\u5916\\u6269\\u5C55\\u3001[\\u672A\\u4F2A\\u88C5\\u90E8\\u5206]\\u670D\\u52A1\\u5668\\u8BC1\\u4E66\\u3001[\\u672A\\u4F2A\\u88C5\\u90E8\\u5206]\\u670D\\u52A1\\u5668\\u8BC1\\u4E66\\u9A8C\\u8BC1\\u3001[\\u672A\\u4F2A\\u88C5\\u90E8\\u5206]\\u670D\\u52A1\\u5668\\u63E1\\u624B\\u5B8C\\u6210\\u3002\\u4E14\\u6563\\u5217\\u7684\\u8F93\\u5165\\u4E0D\\u5305\\u62EC ClientHello \\u548C ServerHello \\u7684 5 \\u5B57\\u8282 \\\\\"TLS \\u8BB0\\u5F55\\\\\" \\u5934\\uFF1B\\u540C\\u65F6\\u4E5F\\u4E0D\\u5305\\u62EC\\u672A\\u4F2A\\u88C5\\u7684\\u8BB0\\u5F55\\u7684\\u5C3E\\u90E8 1 \\u5B57\\u8282\\u7684 \\\\\"\\u8BB0\\u5F55\\u7C7B\\u578B\\\\\"\\u3002\",\"\\u8FD9\\u4E2A 32 \\u5B57\\u8282\\u7684 \\\\\"handshake_hash\\\\\" \\u6700\\u7EC8\\u503C\\u662F\\uFF1A\",{\"Tag\":\"pre\",\"props\":{\"className\":\"ind2\"},\"children\":[{\"Tag\":\"code\",\"props\":{\"className\":\"longboi\"},\"content\":\"fa6800169a6baac19159524fa7b9721b41be3c9db6f3f93fa5ff7e3db3ece204d2b456c51046e40ec5312c55a86126f5\"}]},{\"Tag\":\"CodeSample\",\"props\":{\"code\":\"# strip first 5 bytes of hello records, and trailing byte of unwrapped records\\\\n$ (tail -c +6 clienthello; tail -c +6 serverhello; \\\\\\\\\\\\n   perl -pe \\'s/.$// if eof\\' serverextensions; \\\\\\\\\\\\n   perl -pe \\'s/.$// if eof\\' servercert; \\\\\\\\\\\\n   perl -pe \\'s/.$// if eof\\' servercertverify; \\\\\\\\\\\\n   perl -pe \\'s/.$// if eof\\' serverfinished) | openssl sha384\\\\n\\\\nfa6800169a6baac19159524fa7b9721b41be3c9db6f3f93fa5ff7e3db3ece204d2b456c51046e40ec5312c55a86126f5\\\\n    \"}},\"\\u7136\\u540E\\uFF0C\\u6211\\u4EEC\\u5C06\\u54C8\\u5E0C\\u503C\\u548C\\u5171\\u4EAB\\u7684\\u7B7E\\u540D\\u4FE1\\u606F\\u8FDB\\u884C\\u4E00\\u4E9B\\u5BC6\\u94A5\\u6D3E\\u751F\\u64CD\\u4F5C(key derivation operations)\\uFF0C\\u4EE5\\u9632\\u6B62\\u53EF\\u80FD\\u7684\\u653B\\u51FB\\uFF1A\",{\"Tag\":\"pre\",\"children\":[{\"Tag\":\"code\",\"props\":{\"className\":\"longboi\"},\"content\":\"empty_hash = SHA384(\\\\\"\\\\\")\\\\nderived_secret = HKDF-Expand-Label(key: handshake_secret, label: \\\\\"derived\\\\\", ctx: empty_hash, len: 48)\\\\nmaster_secret = HKDF-Extract(salt: derived_secret, key: 00...)\\\\nclient_secret = HKDF-Expand-Label(key: master_secret, label: \\\\\"c ap traffic\\\\\", ctx: handshake_hash, len: 48)\\\\nserver_secret = HKDF-Expand-Label(key: master_secret, label: \\\\\"s ap traffic\\\\\", ctx: handshake_hash, len: 48)\\\\nclient_application_key = HKDF-Expand-Label(key: client_secret, label: \\\\\"key\\\\\", ctx: \\\\\"\\\\\", len: 32)\\\\nserver_application_key = HKDF-Expand-Label(key: server_secret, label: \\\\\"key\\\\\", ctx: \\\\\"\\\\\", len: 32)\\\\nclient_application_iv = HKDF-Expand-Label(key: client_secret, label: \\\\\"iv\\\\\", ctx: \\\\\"\\\\\", len: 12)\\\\nserver_application_iv = HKDF-Expand-Label(key: server_secret, label: \\\\\"iv\\\\\", ctx: \\\\\"\\\\\", len: 12)\"}]},{\"children\":[\"\\u5728\\u547D\\u4EE4\\u884C\\u4E2D\\u4F7F\\u7528\",{\"Tag\":\"a\",\"props\":{\"href\":\"https://tls13.xargs.org/files/hkdf-384.sh\"},\"content\":\"\\u539F\\u4F5C\\u8005\\u5236\\u4F5C\\u7684 HKDF \\u547D\\u4EE4\\u884C\\u811A\\u672C\"},\"\\uFF0C\\u4F60\\u4E5F\\u53EF\\u4EE5\\u81EA\\u5DF1\\u8BD5\\u8BD5\\uFF1A\"]},{\"Tag\":\"CodeSample\",\"props\":{\"code\":\"$ handshake_hash=fa6800169a6baac19159524fa7b9721b41be3c9db6f3f93fa5ff7e3db3ece204d2b456c51046e40ec5312c55a86126f5\\\\n$ handshake_secret=bdbbe8757494bef20de932598294ea65b5e6bf6dc5c02a960a2de2eaa9b07c929078d2caa0936231c38d1725f179d299\\\\n$ zero_key=000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\\\\n$ empty_hash=$(openssl sha384 < /dev/null | sed -e \\'s/.* //\\')\\\\n$ derived_secret=$(./hkdf-384 expandlabel $handshake_secret \\\\\"derived\\\\\" $empty_hash 48)\\\\n$ master_secret=$(./hkdf-384 extract $derived_secret $zero_key)\\\\n$ csecret=$(./hkdf-384 expandlabel $master_secret \\\\\"c ap traffic\\\\\" $handshake_hash 48)\\\\n$ ssecret=$(./hkdf-384 expandlabel $master_secret \\\\\"s ap traffic\\\\\" $handshake_hash 48)\\\\n$ client_application_key=$(./hkdf-384 expandlabel $csecret \\\\\"key\\\\\" \\\\\"\\\\\" 32)\\\\n$ server_application_key=$(./hkdf-384 expandlabel $ssecret \\\\\"key\\\\\" \\\\\"\\\\\" 32)\\\\n$ client_application_iv=$(./hkdf-384 expandlabel $csecret \\\\\"iv\\\\\" \\\\\"\\\\\" 12)\\\\n$ server_application_iv=$(./hkdf-384 expandlabel $ssecret \\\\\"iv\\\\\" \\\\\"\\\\\" 12)\\\\n$ echo skey: $server_application_key\\\\n$ echo siv: $server_application_iv\\\\n$ echo ckey: $client_application_key\\\\n$ echo civ: $client_application_iv\\\\n\\\\nskey: 01f78623f17e3edcc09e944027ba3218d57c8e0db93cd3ac419309274700ac27\\\\nsiv: 196a750b0c5049c0cc51a541\\\\nckey: de2f4c7672723a692319873e5c227606691a32d1c59d8b9f51dbb9352e9ca9cc\\\\nciv: bb007956f474b25de902432f\"}},\"\\u7531\\u6B64\\u6211\\u4EEC\\u53EF\\u4EE5\\u5F97\\u5230\\u4EE5\\u4E0B\\u5BC6\\u94A5\\u4EE5\\u53CA\\u5411\\u91CF\\uFF1A\",{\"Tag\":\"ul\",\"children\":[{\"Tag\":\"li\",\"children\":[\"\\u5BA2\\u6237\\u7AEF\\u4F1A\\u8BDD\\u5BC6\\u94A5: \",{\"Tag\":\"code\",\"content\":\"de2f4c7672723a692319873e5c227606691a32d1c59d8b9f51dbb9352e9ca9cc\"}]},{\"Tag\":\"li\",\"children\":[\"\\u5BA2\\u6237\\u7AEF\\u4F1A\\u8BDD\\u5411\\u91CF: \",{\"Tag\":\"code\",\"content\":\"bb007956f474b25de902432f\"}]},{\"Tag\":\"li\",\"children\":[\"\\u670D\\u52A1\\u5668\\u7AEF\\u4F1A\\u8BDD\\u5BC6\\u94A5: \",{\"Tag\":\"code\",\"content\":\"01f78623f17e3edcc09e944027ba3218d57c8e0db93cd3ac419309274700ac27\"}]},{\"Tag\":\"li\",\"children\":[\"\\u670D\\u52A1\\u5668\\u7AEF\\u4F1A\\u8BDD\\u5411\\u91CF: \",{\"Tag\":\"code\",\"content\":\"196a750b0c5049c0cc51a541\"}]}]}]');\n\n});\n\n\n//# sourceMappingURL=serverApplicationKeysCalc.d7382182.js.map\n","[\n  \"服务器端现在可以计算应用会话时的密钥了。在这个计算中，服务器使用了以下信息：\",\n  {\n    \"Tag\": \"ul\",\n    \"children\": [\n      {\n        \"Tag\": \"li\",\n        \"content\": \"服务器端密文(之前准备握手密钥时生成)\"\n      },\n      {\n        \"Tag\": \"li\",\n        \"content\": \"ClientHello 到 服务器握手结束 所有握手时包的 SHA256 哈希值\"\n      }\n    ]\n  },\n  \"这个哈希值包括：ClientHello、ServerHello、[未伪装部分]额外扩展、[未伪装部分]服务器证书、[未伪装部分]服务器证书验证、[未伪装部分]服务器握手完成。且散列的输入不包括 ClientHello 和 ServerHello 的 5 字节 \\\"TLS 记录\\\" 头；同时也不包括未伪装的记录的尾部 1 字节的 \\\"记录类型\\\"。\",\n  \"这个 32 字节的 \\\"handshake_hash\\\" 最终值是：\",\n  {\n    \"Tag\": \"pre\",\n    \"props\": {\n      \"className\": \"ind2\"\n    },\n    \"children\": [\n      {\n        \"Tag\": \"code\",\n        \"props\": { \"className\": \"longboi\" },\n        \"content\": \"fa6800169a6baac19159524fa7b9721b41be3c9db6f3f93fa5ff7e3db3ece204d2b456c51046e40ec5312c55a86126f5\"\n      }\n    ]\n  },\n  {\n    \"Tag\": \"CodeSample\",\n    \"props\": {\n      \"code\": \"# strip first 5 bytes of hello records, and trailing byte of unwrapped records\\n$ (tail -c +6 clienthello; tail -c +6 serverhello; \\\\\\n   perl -pe 's/.$// if eof' serverextensions; \\\\\\n   perl -pe 's/.$// if eof' servercert; \\\\\\n   perl -pe 's/.$// if eof' servercertverify; \\\\\\n   perl -pe 's/.$// if eof' serverfinished) | openssl sha384\\n\\nfa6800169a6baac19159524fa7b9721b41be3c9db6f3f93fa5ff7e3db3ece204d2b456c51046e40ec5312c55a86126f5\\n    \"\n    }\n  },\n  \"然后，我们将哈希值和共享的签名信息进行一些密钥派生操作(key derivation operations)，以防止可能的攻击：\",\n  {\n    \"Tag\": \"pre\",\n    \"children\": [\n      {\n        \"Tag\": \"code\",\n        \"props\": { \"className\": \"longboi\" },\n        \"content\": \"empty_hash = SHA384(\\\"\\\")\\nderived_secret = HKDF-Expand-Label(key: handshake_secret, label: \\\"derived\\\", ctx: empty_hash, len: 48)\\nmaster_secret = HKDF-Extract(salt: derived_secret, key: 00...)\\nclient_secret = HKDF-Expand-Label(key: master_secret, label: \\\"c ap traffic\\\", ctx: handshake_hash, len: 48)\\nserver_secret = HKDF-Expand-Label(key: master_secret, label: \\\"s ap traffic\\\", ctx: handshake_hash, len: 48)\\nclient_application_key = HKDF-Expand-Label(key: client_secret, label: \\\"key\\\", ctx: \\\"\\\", len: 32)\\nserver_application_key = HKDF-Expand-Label(key: server_secret, label: \\\"key\\\", ctx: \\\"\\\", len: 32)\\nclient_application_iv = HKDF-Expand-Label(key: client_secret, label: \\\"iv\\\", ctx: \\\"\\\", len: 12)\\nserver_application_iv = HKDF-Expand-Label(key: server_secret, label: \\\"iv\\\", ctx: \\\"\\\", len: 12)\"\n      }\n    ]\n  },\n  {\n    \"children\": [\n      \"在命令行中使用\",\n      {\n        \"Tag\": \"a\",\n        \"props\": { \"href\": \"https://tls13.xargs.org/files/hkdf-384.sh\" },\n        \"content\": \"原作者制作的 HKDF 命令行脚本\"\n      },\n      \"，你也可以自己试试：\"\n    ]\n  },\n  {\n    \"Tag\": \"CodeSample\",\n    \"props\": {\n      \"code\": \"$ handshake_hash=fa6800169a6baac19159524fa7b9721b41be3c9db6f3f93fa5ff7e3db3ece204d2b456c51046e40ec5312c55a86126f5\\n$ handshake_secret=bdbbe8757494bef20de932598294ea65b5e6bf6dc5c02a960a2de2eaa9b07c929078d2caa0936231c38d1725f179d299\\n$ zero_key=000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\\n$ empty_hash=$(openssl sha384 < /dev/null | sed -e 's/.* //')\\n$ derived_secret=$(./hkdf-384 expandlabel $handshake_secret \\\"derived\\\" $empty_hash 48)\\n$ master_secret=$(./hkdf-384 extract $derived_secret $zero_key)\\n$ csecret=$(./hkdf-384 expandlabel $master_secret \\\"c ap traffic\\\" $handshake_hash 48)\\n$ ssecret=$(./hkdf-384 expandlabel $master_secret \\\"s ap traffic\\\" $handshake_hash 48)\\n$ client_application_key=$(./hkdf-384 expandlabel $csecret \\\"key\\\" \\\"\\\" 32)\\n$ server_application_key=$(./hkdf-384 expandlabel $ssecret \\\"key\\\" \\\"\\\" 32)\\n$ client_application_iv=$(./hkdf-384 expandlabel $csecret \\\"iv\\\" \\\"\\\" 12)\\n$ server_application_iv=$(./hkdf-384 expandlabel $ssecret \\\"iv\\\" \\\"\\\" 12)\\n$ echo skey: $server_application_key\\n$ echo siv: $server_application_iv\\n$ echo ckey: $client_application_key\\n$ echo civ: $client_application_iv\\n\\nskey: 01f78623f17e3edcc09e944027ba3218d57c8e0db93cd3ac419309274700ac27\\nsiv: 196a750b0c5049c0cc51a541\\nckey: de2f4c7672723a692319873e5c227606691a32d1c59d8b9f51dbb9352e9ca9cc\\nciv: bb007956f474b25de902432f\"\n    }\n  },\n  \"由此我们可以得到以下密钥以及向量：\",\n  {\n    \"Tag\": \"ul\",\n    \"children\": [\n      {\n        \"Tag\": \"li\",\n        \"children\": [\n          \"客户端会话密钥: \",\n          {\n            \"Tag\": \"code\",\n            \"content\": \"de2f4c7672723a692319873e5c227606691a32d1c59d8b9f51dbb9352e9ca9cc\"\n          }\n        ]\n      },\n      {\n        \"Tag\": \"li\",\n        \"children\": [\n          \"客户端会话向量: \",\n          {\n            \"Tag\": \"code\",\n            \"content\": \"bb007956f474b25de902432f\"\n          }\n        ]\n      },\n      {\n        \"Tag\": \"li\",\n        \"children\": [\n          \"服务器端会话密钥: \",\n          {\n            \"Tag\": \"code\",\n            \"content\": \"01f78623f17e3edcc09e944027ba3218d57c8e0db93cd3ac419309274700ac27\"\n          }\n        ]\n      },\n      {\n        \"Tag\": \"li\",\n        \"children\": [\n          \"服务器端会话向量: \",\n          {\n            \"Tag\": \"code\",\n            \"content\": \"196a750b0c5049c0cc51a541\"\n          }\n        ]\n      }\n    ]\n  }\n]\n"],"names":["parcelRequire","$parcel$global","globalThis","register","module","exports","JSON","parse"],"version":3,"file":"serverApplicationKeysCalc.d7382182.js.map"}