{"mappings":"A,C,E,A,A,W,iB,C,Q,A,E,Q,S,C,C,C,ECAA,EAAA,OAAA,CAAiB,KAAK,KAAK,CAAC,61E","sources":["<anon>","src/TLS12/clientApplicationData.json"],"sourcesContent":["\n      var $parcel$global = globalThis;\n    var parcelRequire = $parcel$global[\"parcelRequire7f38\"];\nvar parcelRegister = parcelRequire.register;\nparcelRegister(\"7MqEz\", function(module, exports) {\nmodule.exports = JSON.parse('[\"\\u6B64\\u65F6\\u5BA2\\u6237\\u7AEF\\u548C\\u670D\\u52A1\\u5668\\u5C31\\u53EF\\u4EE5\\u5F00\\u59CB\\u6B63\\u5F0F\\u7684 TLS 1.2 \\u4F1A\\u8BDD\\u4E86\\u3002\",\"\\u5BA2\\u6237\\u7AEF\\u9996\\u5148\\u53D1\\u9001\\u5B83\\u7684\\u6570\\u636E\\uFF0C\\u5B57\\u7B26\\u4E32\\\\\"ping\\\\\"\\u3002\",{\"Tag\":\"AnnotationToggler\"},{\"Tag\":\"Annotations\",\"props\":{\"type\":\"record-data\",\"data\":[[\"\\u8BB0\\u5F55\\u5934\",{\"props\":{\"className\":\"bytes\"},\"content\":\"17 03 03 00 30\"},[\"TLS \\u4F1A\\u8BDD\\u88AB\\u5206\\u89E3\\u6210 \\\\\"\\u8BB0\\u5F55\\\\\"(record) \\u7684\\u5F62\\u5F0F\\u53D1\\u9001\\u548C\\u63A5\\u6536\\u3002\\u8BB0\\u5F55\\u662F\\u5177\\u6709\\u7C7B\\u578B\\u3001\\u534F\\u8BAE\\u7248\\u672C\\u548C\\u957F\\u5EA6\\u7684\\u6570\\u636E\\u5757\\u3002\",{\"Tag\":\"ul\",\"children\":[{\"Tag\":\"li\",\"content\":\"17 - \\u8868\\u793A TLS \\u8BB0\\u5F55\\u7C7B\\u578B 0x17(23, application data)\"},{\"Tag\":\"li\",\"content\":\"03 03 - \\u534F\\u8BAE\\u7248\\u672C (3.3, \\u5373 TLS 1.2)\"},{\"Tag\":\"li\",\"content\":\"00 30 - \\u7D27\\u63A5\\u7740\\u7684\\u6570\\u7EC4\\u8F7D\\u8377\\u957F\\u5EA6 0x30(48) \\u5B57\\u8282\"}]}]],[\"\\u52A0\\u5BC6\\u5411\\u91CF\",{\"props\":{\"className\":\"bytes\"},\"content\":\"00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f\"},[\"\\u5BA2\\u6237\\u7AEF\\u53D1\\u9001\\u4E00\\u4E2A\\u7528\\u4E8E\\u89E3\\u5BC6\\u8FD9\\u4E2A\\u533A\\u5757\\u7684\\u521D\\u59CB\\u5316\\u5411\\u91CF\\u3002\\u56E0\\u4E3A\\u6211\\u4EEC\\u7684\\u6570\\u636E\\u662F\\u53EF\\u9884\\u6D4B\\u7684(we have overridden the rand function)\\uFF0C\\u56E0\\u6B64\\u5B83\\u4E5F\\u662F\\u4E00\\u4E2A\\u53EF\\u9884\\u6D4B\\u7684\\u5E8F\\u5217\\u3002\"]],[\"\\u52A0\\u5BC6\\u7684\\u6570\\u636E\\u8F7D\\u8377\",{\"props\":{\"className\":\"bytes encrypted\"},\"content\":\"6c 42 1c 71 c4 2b 18 3b fa 06 19 5d 13 3d 0a 09 d0 0f c7 cb 4e 0f 5d 1c da 59 d1 47 ec 79 0c 99\"},[\"\\u8FD9\\u4E2A\\u6570\\u636E\\u662F\\u7528\\u5BA2\\u6237\\u7AEF\\u7684\\u5199\\u65F6\\u5BC6\\u94A5\\u52A0\\u5BC6\\u7684\\u3002\\u56E0\\u4E3A\\u5B83\\u5305\\u542B\\u4E00\\u4E2A\\u6D88\\u606F\\u9A8C\\u8BC1\\u7801(MAC)\\u548C\\u586B\\u5145\\u5B57\\u8282\\uFF0C\\u6240\\u4EE5\\u5B83\\u6BD4\\u89E3\\u5BC6\\u540E\\u7684\\u6570\\u636E\\u8981\\u5927\\u4E00\\u622A\\u3002\"]]]}},{\"Tag\":\"Annotations\",\"props\":{\"data\":[[\"\",{\"props\":{\"className\":\"decryption-header\"},\"content\":\"\\u89E3\\u5BC6\\u540E\\u7684\\u6570\\u636E\\u8F7D\\u8377\"},[{\"Tag\":\"h4\",\"content\":\"\\u89E3\\u5BC6\"},\"\\u6570\\u636E\\u88AB \\\\\"\\u5BA2\\u6237\\u7AEF\\u751F\\u6210\\u4F1A\\u8BDD\\u5BC6\\u94A5\\\\\" \\u6B65\\u9AA4\\u4E2D\\u4EA7\\u751F\\u7684\\u5199\\u65F6\\u5BC6\\u94A5\\u548C\\u8BE5\\u8BB0\\u5F55\\u5F00\\u5934\\u6240\\u643A\\u5E26\\u7684\\u521D\\u59CB\\u5411\\u91CF(IVs)\\u52A0\\u5BC6\\u3002\",{\"Tag\":\"CodeSample\",\"props\":{\"code\":\"### client key\\\\n$ hexkey=f656d037b173ef3e11169f27231a84b6\\\\n### IV for this record\\\\n$ hexiv=000102030405060708090a0b0c0d0e0f\\\\n### encrypted data\\\\n$ echo \\'6c 42 1c 71 c4 2b 18 3b fa 06 19 5d 13 3d 0a 09\\'  > /tmp/msg1\\\\n$ echo \\'d0 0f c7 cb 4e 0f 5d 1c da 59 d1 47 ec 79 0c 99\\' >> /tmp/msg1\\\\n$ xxd -r -p /tmp/msg1 \\\\\\\\\\\\n  | openssl enc -d -nopad -aes-128-cbc -K $hexkey -iv $hexiv | hexdump\\\\n\\\\n0000000 70 69 6e 67 60 10 12 49 f7 4a 03 77 c9 ca cf 63\\\\n0000010 09 75 13 70 d8 0c fc aa 07 07 07 07 07 07 07 07\\\\n\\\\nThe last 28 bytes contain a 20-byte MAC and padding to bring the data to a\\\\nmultiple of 16 bytes.  The 20-byte MAC can be reproduced as follows:\\\\n\\\\n### from https://tools.ietf.org/html/rfc2246#section-6.2.3.1\\\\n$ sequence=\\'0000000000000001\\'\\\\n$ rechdr=\\'17 03 03\\'\\\\n$ datalen=\\'00 04\\'\\\\n$ data=\\'70 69 6e 67\\'\\\\n### from \\\\\"Encryption Keys Calculation\\\\\"\\\\n$ mackey=1b7d117c7d5f690bc263cae8ef60af0f1878acc2\\\\n$ echo $sequence $rechdr $datalen $data | xxd -r -p \\\\\\\\\\\\n  | openssl dgst -sha1 -mac HMAC -macopt hexkey:$mackey\\\\n\\\\n60101249f74a0377c9cacf6309751370d80cfcaa\"}}]]]}},{\"Tag\":\"Annotations\",\"props\":{\"type\":\"record-data\",\"data\":[[\"\\u6570\\u636E\\u8F7D\\u8377\",{\"props\":{\"className\":\"bytes encrypted\"},\"content\":\"70 69 6e 67\"},[\"\\u5B57\\u7B26\\u4E32\\\\\"ping\\\\\"\"]]]}}]');\n\n});\n\n\n//# sourceMappingURL=clientApplicationData.528b72de.js.map\n","[\n  \"此时客户端和服务器就可以开始正式的 TLS 1.2 会话了。\",\n  \"客户端首先发送它的数据，字符串\\\"ping\\\"。\",\n  {\n    \"Tag\": \"AnnotationToggler\"\n  },\n  {\n    \"Tag\": \"Annotations\",\n    \"props\": {\n      \"type\": \"record-data\",\n      \"data\": [\n        [\n          \"记录头\",\n          {\n            \"props\": {\n              \"className\": \"bytes\"\n            },\n            \"content\": \"17 03 03 00 30\"\n          },\n          [\n            \"TLS 会话被分解成 \\\"记录\\\"(record) 的形式发送和接收。记录是具有类型、协议版本和长度的数据块。\",\n            {\n              \"Tag\": \"ul\",\n              \"children\": [\n                {\n                  \"Tag\": \"li\",\n                  \"content\": \"17 - 表示 TLS 记录类型 0x17(23, application data)\"\n                },\n                {\n                  \"Tag\": \"li\",\n                  \"content\": \"03 03 - 协议版本 (3.3, 即 TLS 1.2)\"\n                },\n                {\n                  \"Tag\": \"li\",\n                  \"content\": \"00 30 - 紧接着的数组载荷长度 0x30(48) 字节\"\n                }\n              ]\n            }\n          ]\n        ],\n        [\n          \"加密向量\",\n          {\n            \"props\": {\n              \"className\": \"bytes\"\n            },\n            \"content\": \"00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f\"\n          },\n          [\n            \"客户端发送一个用于解密这个区块的初始化向量。因为我们的数据是可预测的(we have overridden the rand function)，因此它也是一个可预测的序列。\"\n          ]\n        ],\n        [\n          \"加密的数据载荷\",\n          {\n            \"props\": {\n              \"className\": \"bytes encrypted\"\n            },\n            \"content\": \"6c 42 1c 71 c4 2b 18 3b fa 06 19 5d 13 3d 0a 09 d0 0f c7 cb 4e 0f 5d 1c da 59 d1 47 ec 79 0c 99\"\n          },\n          [\n            \"这个数据是用客户端的写时密钥加密的。因为它包含一个消息验证码(MAC)和填充字节，所以它比解密后的数据要大一截。\"\n          ]\n        ]\n      ]\n    }\n  },\n  {\n    \"Tag\": \"Annotations\",\n    \"props\": {\n      \"data\": [\n        [\n          \"\",\n          {\n            \"props\": {\n              \"className\": \"decryption-header\"\n            },\n            \"content\": \"解密后的数据载荷\"\n          },\n          [\n            { \"Tag\": \"h4\", \"content\": \"解密\" },\n            \"数据被 \\\"客户端生成会话密钥\\\" 步骤中产生的写时密钥和该记录开头所携带的初始向量(IVs)加密。\",\n            {\n              \"Tag\": \"CodeSample\",\n              \"props\": {\n                \"code\": \"### client key\\n$ hexkey=f656d037b173ef3e11169f27231a84b6\\n### IV for this record\\n$ hexiv=000102030405060708090a0b0c0d0e0f\\n### encrypted data\\n$ echo '6c 42 1c 71 c4 2b 18 3b fa 06 19 5d 13 3d 0a 09'  > /tmp/msg1\\n$ echo 'd0 0f c7 cb 4e 0f 5d 1c da 59 d1 47 ec 79 0c 99' >> /tmp/msg1\\n$ xxd -r -p /tmp/msg1 \\\\\\n  | openssl enc -d -nopad -aes-128-cbc -K $hexkey -iv $hexiv | hexdump\\n\\n0000000 70 69 6e 67 60 10 12 49 f7 4a 03 77 c9 ca cf 63\\n0000010 09 75 13 70 d8 0c fc aa 07 07 07 07 07 07 07 07\\n\\nThe last 28 bytes contain a 20-byte MAC and padding to bring the data to a\\nmultiple of 16 bytes.  The 20-byte MAC can be reproduced as follows:\\n\\n### from https://tools.ietf.org/html/rfc2246#section-6.2.3.1\\n$ sequence='0000000000000001'\\n$ rechdr='17 03 03'\\n$ datalen='00 04'\\n$ data='70 69 6e 67'\\n### from \\\"Encryption Keys Calculation\\\"\\n$ mackey=1b7d117c7d5f690bc263cae8ef60af0f1878acc2\\n$ echo $sequence $rechdr $datalen $data | xxd -r -p \\\\\\n  | openssl dgst -sha1 -mac HMAC -macopt hexkey:$mackey\\n\\n60101249f74a0377c9cacf6309751370d80cfcaa\"\n              }\n            }\n          ]\n        ]\n      ]\n    }\n  },\n  {\n    \"Tag\": \"Annotations\",\n    \"props\": {\n      \"type\": \"record-data\",\n      \"data\": [\n        [\n          \"数据载荷\",\n          {\n            \"props\": {\n              \"className\": \"bytes encrypted\"\n            },\n            \"content\": \"70 69 6e 67\"\n          },\n          [\"字符串\\\"ping\\\"\"]\n        ]\n      ]\n    }\n  }\n]\n"],"names":["parcelRequire","$parcel$global","globalThis","register","module","exports","JSON","parse"],"version":3,"file":"clientApplicationData.528b72de.js.map"}