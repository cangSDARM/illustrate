{"mappings":"A,C,E,A,A,W,iB,C,Q,A,E,Q,S,C,C,C,ECAA,EAAA,OAAA,CAAiB,KAAK,KAAK,CAAC,u2I","sources":["<anon>","src/DTLS/serverApplicationKeysCalc.json"],"sourcesContent":["\n      var $parcel$global = globalThis;\n    var parcelRequire = $parcel$global[\"parcelRequire7f38\"];\nvar parcelRegister = parcelRequire.register;\nparcelRegister(\"cGItd\", function(module, exports) {\nmodule.exports = JSON.parse('[\"\\u670D\\u52A1\\u5668\\u7AEF\\u73B0\\u5728\\u53EF\\u4EE5\\u8BA1\\u7B97\\u5E94\\u7528\\u4F1A\\u8BDD\\u65F6\\u7684\\u5BC6\\u94A5\\u4E86\\u3002\\u5728\\u8FD9\\u4E2A\\u8BA1\\u7B97\\u4E2D\\uFF0C\\u670D\\u52A1\\u5668\\u4F7F\\u7528\\u4E86\\u4EE5\\u4E0B\\u4FE1\\u606F\\uFF1A\",{\"Tag\":\"ul\",\"children\":[{\"Tag\":\"li\",\"content\":\"\\u670D\\u52A1\\u5668\\u7AEF\\u5BC6\\u6587(\\u4E4B\\u524D\\u51C6\\u5907\\u63E1\\u624B\\u5BC6\\u94A5\\u65F6\\u751F\\u6210)\"},{\"Tag\":\"li\",\"content\":\"ClientHello \\u5230 \\u670D\\u52A1\\u5668\\u63E1\\u624B\\u7ED3\\u675F \\u6240\\u6709\\u63E1\\u624B\\u65F6\\u5305\\u7684 SHA256 \\u54C8\\u5E0C\\u503C(\\u54C8\\u5E0C\\u503C\\u7684\\u8F93\\u5165\\u4E0D\\u5305\\u62EC\\u660E\\u6587\\u7684\\u8BB0\\u5F55\\u5934\\u90E8\\u3001DTLS \\u7279\\u6709\\u7684\\u8BB0\\u5F55\\u5934\\u4EE5\\u53CA\\u6700\\u540E 1 \\u5B57\\u8282\\u7684\\u8BB0\\u5F55\\u7C7B\\u578B)\"}]},\"32 \\u5B57\\u8282\\u7684 \\\\\"handshake_hash\\\\\" \\u6700\\u7EC8\\u503C\\u662F\\uFF1A\",{\"Tag\":\"pre\",\"props\":{\"className\":\"ind2\"},\"children\":[{\"Tag\":\"code\",\"props\":{\"className\":\"longboi\"},\"content\":\"77ff5eee528abc269960b0ea316eb8578dc8325d86ec1336ffe4b2941e26d82b\"}]},{\"Tag\":\"CodeSample\",\"props\":{\"code\":\"$ (\\\\n  cat record-chello  | perl -0777 -pe \\'s/.{13}(.{4}).{8}/$1/\\';\\\\n  cat record-shello  | perl -0777 -pe \\'s/.{13}(.{4}).{8}/$1/\\';\\\\n  cat record-encext  | perl -0777 -pe \\'s/(.{4}).{8}(.*).$/$1$2/s\\';\\\\n  cat record-cert    | perl -0777 -pe \\'s/(.{4}).{8}(.*).$/$1$2/s\\';\\\\n  cat record-cverify | perl -0777 -pe \\'s/(.{4}).{8}(.*).$/$1$2/s\\';\\\\n  cat record-sfin    | perl -0777 -pe \\'s/(.{4}).{8}(.*).$/$1$2/s\\';\\\\n  )| openssl sha256\\\\n\\\\n77ff5eee528abc269960b0ea316eb8578dc8325d86ec1336ffe4b2941e26d82b\"}},\"\\u7136\\u540E\\uFF0C\\u6211\\u4EEC\\u5C06\\u54C8\\u5E0C\\u503C\\u548C\\u5171\\u4EAB\\u7684\\u7B7E\\u540D\\u4FE1\\u606F\\u8FDB\\u884C\\u4E00\\u4E9B\\u5BC6\\u94A5\\u6D3E\\u751F\\u64CD\\u4F5C(key derivation operations)\\uFF0C\\u4EE5\\u9632\\u6B62\\u53EF\\u80FD\\u7684\\u653B\\u51FB\\uFF1A\",{\"Tag\":\"pre\",\"children\":[{\"Tag\":\"code\",\"props\":{\"className\":\"longboi\"},\"content\":\"empty_hash = SHA256(\\\\\"\\\\\")\\\\nderived_secret = HKDF-Expand-Label(key: handshake_secret, label: \\\\\"derived\\\\\", ctx: empty_hash, len: 32)\\\\nmaster_secret = HKDF-Extract(salt: derived_secret, key: 00...)\\\\nclient_secret = HKDF-Expand-Label(key: master_secret, label: \\\\\"c ap traffic\\\\\", ctx: handshake_hash, len: 32)\\\\nserver_secret = HKDF-Expand-Label(key: master_secret, label: \\\\\"s ap traffic\\\\\", ctx: handshake_hash, len: 32)\\\\nclient_application_key = HKDF-Expand-Label(key: client_secret, label: \\\\\"key\\\\\", ctx: \\\\\"\\\\\", len: 16)\\\\nserver_application_key = HKDF-Expand-Label(key: server_secret, label: \\\\\"key\\\\\", ctx: \\\\\"\\\\\", len: 16)\\\\nclient_application_iv = HKDF-Expand-Label(key: client_secret, label: \\\\\"iv\\\\\", ctx: \\\\\"\\\\\", len: 12)\\\\nserver_application_iv = HKDF-Expand-Label(key: server_secret, label: \\\\\"iv\\\\\", ctx: \\\\\"\\\\\", len: 12)\"}]},{\"children\":[\"\\u5728\\u547D\\u4EE4\\u884C\\u4E2D\\u4F7F\\u7528\",{\"Tag\":\"a\",\"props\":{\"href\":\"https://dtls.xargs.org/files/hkdf-dtls.sh\"},\"content\":\"\\u539F\\u4F5C\\u8005\\u5236\\u4F5C\\u7684 HKDF \\u547D\\u4EE4\\u884C\\u811A\\u672C\"},\"\\uFF0C\\u4F60\\u4E5F\\u53EF\\u4EE5\\u81EA\\u5DF1\\u8BD5\\u8BD5\\uFF1A\"]},{\"Tag\":\"CodeSample\",\"props\":{\"code\":\"$ handshake_hash=77ff5eee528abc269960b0ea316eb8578dc8325d86ec1336ffe4b2941e26d82b\\\\n$ handshake_secret=d0d1397bb3c445d37f26f7ed00c83b73d2f67540de3761465ffe524f8f944e12\\\\n$ zero_key=0000000000000000000000000000000000000000000000000000000000000000\\\\n$ empty_hash=$(openssl sha256 < /dev/null | sed -e \\'s/.* //\\')\\\\n$ derived_secret=$(./hkdf-dtls expandlabel $handshake_secret \\\\\"derived\\\\\" $empty_hash 32)\\\\n$ master_secret=$(./hkdf-dtls extract $derived_secret $zero_key)\\\\n$ csecret=$(./hkdf-dtls expandlabel $master_secret \\\\\"c ap traffic\\\\\" $handshake_hash 32)\\\\n$ ssecret=$(./hkdf-dtls expandlabel $master_secret \\\\\"s ap traffic\\\\\" $handshake_hash 32)\\\\n$ client_application_key=$(./hkdf-dtls expandlabel $csecret \\\\\"key\\\\\" \\\\\"\\\\\" 16)\\\\n$ server_application_key=$(./hkdf-dtls expandlabel $ssecret \\\\\"key\\\\\" \\\\\"\\\\\" 16)\\\\n$ client_application_iv=$(./hkdf-dtls expandlabel $csecret \\\\\"iv\\\\\" \\\\\"\\\\\" 12)\\\\n$ server_application_iv=$(./hkdf-dtls expandlabel $ssecret \\\\\"iv\\\\\" \\\\\"\\\\\" 12)\\\\n$ client_sn_key=$(./hkdf-dtls expandlabel $csecret \\\\\"sn\\\\\" \\\\\"\\\\\" 16)\\\\n$ server_sn_key=$(./hkdf-dtls expandlabel $ssecret \\\\\"sn\\\\\" \\\\\"\\\\\" 16)\\\\n$ echo client_key: $client_application_key\\\\n$ echo client_iv: $client_application_iv\\\\n$ echo server_key: $server_application_key\\\\n$ echo server_iv: $server_application_iv\\\\n$ echo client_sn_key: $client_sn_key\\\\n$ echo server_sn_key: $server_sn_key\\\\n\\\\nclient_key: 9ba90dbce8857bc1fcb81d41a0465cfe\\\\nclient_iv: 682219974631fa0656ee4eff\\\\nserver_key: 2b65fffbbc8189474aa2003c43c32d4d\\\\nserver_iv: 582f5a11bdaf973fe3ffeb4e\\\\nclient_sn_key: 5cb5bd8bac29777c650c0dde22d16d47\\\\nserver_sn_key: 57ba02596c6a1352d7fe8416c7e17d5a\"}},\"\\u7531\\u6B64\\u6211\\u4EEC\\u53EF\\u4EE5\\u5F97\\u5230\\u4EE5\\u4E0B\\u5BC6\\u94A5\\u4EE5\\u53CA\\u5411\\u91CF\\uFF1A\",{\"Tag\":\"ul\",\"children\":[{\"Tag\":\"li\",\"children\":[\"\\u5BA2\\u6237\\u7AEF\\u4F1A\\u8BDD\\u5BC6\\u94A5: \",{\"Tag\":\"code\",\"content\":\"9ba90dbce8857bc1fcb81d41a0465cfe\"}]},{\"Tag\":\"li\",\"children\":[\"\\u5BA2\\u6237\\u7AEF\\u4F1A\\u8BDD\\u5411\\u91CF: \",{\"Tag\":\"code\",\"content\":\"682219974631fa0656ee4eff\"}]},{\"Tag\":\"li\",\"children\":[\"\\u5BA2\\u6237\\u7AEF\\u5E8F\\u53F7\\u4FDD\\u62A4\\u5BC6\\u94A5: \",{\"Tag\":\"code\",\"content\":\"5cb5bd8bac29777c650c0dde22d16d47\"}]},{\"Tag\":\"li\",\"children\":[\"\\u670D\\u52A1\\u5668\\u7AEF\\u4F1A\\u8BDD\\u5BC6\\u94A5: \",{\"Tag\":\"code\",\"content\":\"2b65fffbbc8189474aa2003c43c32d4d\"}]},{\"Tag\":\"li\",\"children\":[\"\\u670D\\u52A1\\u5668\\u7AEF\\u4F1A\\u8BDD\\u5411\\u91CF: \",{\"Tag\":\"code\",\"content\":\"582f5a11bdaf973fe3ffeb4e\"}]},{\"Tag\":\"li\",\"children\":[\"\\u670D\\u52A1\\u5668\\u7AEF\\u5E8F\\u53F7\\u4FDD\\u62A4\\u5BC6\\u94A5: \",{\"Tag\":\"code\",\"content\":\"57ba02596c6a1352d7fe8416c7e17d5a\"}]}]}]');\n\n});\n\n\n//# sourceMappingURL=serverApplicationKeysCalc.a9addbf8.js.map\n","[\n  \"服务器端现在可以计算应用会话时的密钥了。在这个计算中，服务器使用了以下信息：\",\n  {\n    \"Tag\": \"ul\",\n    \"children\": [\n      {\n        \"Tag\": \"li\",\n        \"content\": \"服务器端密文(之前准备握手密钥时生成)\"\n      },\n      {\n        \"Tag\": \"li\",\n        \"content\": \"ClientHello 到 服务器握手结束 所有握手时包的 SHA256 哈希值(哈希值的输入不包括明文的记录头部、DTLS 特有的记录头以及最后 1 字节的记录类型)\"\n      }\n    ]\n  },\n  \"32 字节的 \\\"handshake_hash\\\" 最终值是：\",\n  {\n    \"Tag\": \"pre\",\n    \"props\": {\n      \"className\": \"ind2\"\n    },\n    \"children\": [\n      {\n        \"Tag\": \"code\",\n        \"props\": { \"className\": \"longboi\" },\n        \"content\": \"77ff5eee528abc269960b0ea316eb8578dc8325d86ec1336ffe4b2941e26d82b\"\n      }\n    ]\n  },\n  {\n    \"Tag\": \"CodeSample\",\n    \"props\": {\n      \"code\": \"$ (\\n  cat record-chello  | perl -0777 -pe 's/.{13}(.{4}).{8}/$1/';\\n  cat record-shello  | perl -0777 -pe 's/.{13}(.{4}).{8}/$1/';\\n  cat record-encext  | perl -0777 -pe 's/(.{4}).{8}(.*).$/$1$2/s';\\n  cat record-cert    | perl -0777 -pe 's/(.{4}).{8}(.*).$/$1$2/s';\\n  cat record-cverify | perl -0777 -pe 's/(.{4}).{8}(.*).$/$1$2/s';\\n  cat record-sfin    | perl -0777 -pe 's/(.{4}).{8}(.*).$/$1$2/s';\\n  )| openssl sha256\\n\\n77ff5eee528abc269960b0ea316eb8578dc8325d86ec1336ffe4b2941e26d82b\"\n    }\n  },\n  \"然后，我们将哈希值和共享的签名信息进行一些密钥派生操作(key derivation operations)，以防止可能的攻击：\",\n  {\n    \"Tag\": \"pre\",\n    \"children\": [\n      {\n        \"Tag\": \"code\",\n        \"props\": { \"className\": \"longboi\" },\n        \"content\": \"empty_hash = SHA256(\\\"\\\")\\nderived_secret = HKDF-Expand-Label(key: handshake_secret, label: \\\"derived\\\", ctx: empty_hash, len: 32)\\nmaster_secret = HKDF-Extract(salt: derived_secret, key: 00...)\\nclient_secret = HKDF-Expand-Label(key: master_secret, label: \\\"c ap traffic\\\", ctx: handshake_hash, len: 32)\\nserver_secret = HKDF-Expand-Label(key: master_secret, label: \\\"s ap traffic\\\", ctx: handshake_hash, len: 32)\\nclient_application_key = HKDF-Expand-Label(key: client_secret, label: \\\"key\\\", ctx: \\\"\\\", len: 16)\\nserver_application_key = HKDF-Expand-Label(key: server_secret, label: \\\"key\\\", ctx: \\\"\\\", len: 16)\\nclient_application_iv = HKDF-Expand-Label(key: client_secret, label: \\\"iv\\\", ctx: \\\"\\\", len: 12)\\nserver_application_iv = HKDF-Expand-Label(key: server_secret, label: \\\"iv\\\", ctx: \\\"\\\", len: 12)\"\n      }\n    ]\n  },\n  {\n    \"children\": [\n      \"在命令行中使用\",\n      {\n        \"Tag\": \"a\",\n        \"props\": { \"href\": \"https://dtls.xargs.org/files/hkdf-dtls.sh\" },\n        \"content\": \"原作者制作的 HKDF 命令行脚本\"\n      },\n      \"，你也可以自己试试：\"\n    ]\n  },\n  {\n    \"Tag\": \"CodeSample\",\n    \"props\": {\n      \"code\": \"$ handshake_hash=77ff5eee528abc269960b0ea316eb8578dc8325d86ec1336ffe4b2941e26d82b\\n$ handshake_secret=d0d1397bb3c445d37f26f7ed00c83b73d2f67540de3761465ffe524f8f944e12\\n$ zero_key=0000000000000000000000000000000000000000000000000000000000000000\\n$ empty_hash=$(openssl sha256 < /dev/null | sed -e 's/.* //')\\n$ derived_secret=$(./hkdf-dtls expandlabel $handshake_secret \\\"derived\\\" $empty_hash 32)\\n$ master_secret=$(./hkdf-dtls extract $derived_secret $zero_key)\\n$ csecret=$(./hkdf-dtls expandlabel $master_secret \\\"c ap traffic\\\" $handshake_hash 32)\\n$ ssecret=$(./hkdf-dtls expandlabel $master_secret \\\"s ap traffic\\\" $handshake_hash 32)\\n$ client_application_key=$(./hkdf-dtls expandlabel $csecret \\\"key\\\" \\\"\\\" 16)\\n$ server_application_key=$(./hkdf-dtls expandlabel $ssecret \\\"key\\\" \\\"\\\" 16)\\n$ client_application_iv=$(./hkdf-dtls expandlabel $csecret \\\"iv\\\" \\\"\\\" 12)\\n$ server_application_iv=$(./hkdf-dtls expandlabel $ssecret \\\"iv\\\" \\\"\\\" 12)\\n$ client_sn_key=$(./hkdf-dtls expandlabel $csecret \\\"sn\\\" \\\"\\\" 16)\\n$ server_sn_key=$(./hkdf-dtls expandlabel $ssecret \\\"sn\\\" \\\"\\\" 16)\\n$ echo client_key: $client_application_key\\n$ echo client_iv: $client_application_iv\\n$ echo server_key: $server_application_key\\n$ echo server_iv: $server_application_iv\\n$ echo client_sn_key: $client_sn_key\\n$ echo server_sn_key: $server_sn_key\\n\\nclient_key: 9ba90dbce8857bc1fcb81d41a0465cfe\\nclient_iv: 682219974631fa0656ee4eff\\nserver_key: 2b65fffbbc8189474aa2003c43c32d4d\\nserver_iv: 582f5a11bdaf973fe3ffeb4e\\nclient_sn_key: 5cb5bd8bac29777c650c0dde22d16d47\\nserver_sn_key: 57ba02596c6a1352d7fe8416c7e17d5a\"\n    }\n  },\n  \"由此我们可以得到以下密钥以及向量：\",\n  {\n    \"Tag\": \"ul\",\n    \"children\": [\n      {\n        \"Tag\": \"li\",\n        \"children\": [\n          \"客户端会话密钥: \",\n          {\n            \"Tag\": \"code\",\n            \"content\": \"9ba90dbce8857bc1fcb81d41a0465cfe\"\n          }\n        ]\n      },\n      {\n        \"Tag\": \"li\",\n        \"children\": [\n          \"客户端会话向量: \",\n          {\n            \"Tag\": \"code\",\n            \"content\": \"682219974631fa0656ee4eff\"\n          }\n        ]\n      },\n      {\n        \"Tag\": \"li\",\n        \"children\": [\n          \"客户端序号保护密钥: \",\n          {\n            \"Tag\": \"code\",\n            \"content\": \"5cb5bd8bac29777c650c0dde22d16d47\"\n          }\n        ]\n      },\n      {\n        \"Tag\": \"li\",\n        \"children\": [\n          \"服务器端会话密钥: \",\n          {\n            \"Tag\": \"code\",\n            \"content\": \"2b65fffbbc8189474aa2003c43c32d4d\"\n          }\n        ]\n      },\n      {\n        \"Tag\": \"li\",\n        \"children\": [\n          \"服务器端会话向量: \",\n          {\n            \"Tag\": \"code\",\n            \"content\": \"582f5a11bdaf973fe3ffeb4e\"\n          }\n        ]\n      },\n      {\n        \"Tag\": \"li\",\n        \"children\": [\n          \"服务器端序号保护密钥: \",\n          {\n            \"Tag\": \"code\",\n            \"content\": \"57ba02596c6a1352d7fe8416c7e17d5a\"\n          }\n        ]\n      }\n    ]\n  }\n]\n"],"names":["parcelRequire","$parcel$global","globalThis","register","module","exports","JSON","parse"],"version":3,"file":"serverApplicationKeysCalc.a9addbf8.js.map"}