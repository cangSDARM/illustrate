{"mappings":"mMAAAA,EAAAC,QAAiBC,KAAKC,MAAM,ooD","sources":["src/QUIC/clientTLSHandshakeFinished.json"],"sourcesContent":["[\n  \"为了验证握手成功且没有被篡改过，客户端也和服务器端一样，会创建一些验证数据给服务器端确认。验证数据是所有握手信息的哈希值。\",\n  {\n    \"Tag\": \"AnnotationToggler\"\n  },\n  {\n    \"Tag\": \"Annotations\",\n    \"props\": {\n      \"type\": \"record-data\",\n      \"data\": [\n        [\n          \"TLS 握手帧头\",\n          {\n            \"props\": {\n              \"className\": \"bytes\"\n            },\n            \"content\": \"14 00 00 20\"\n          },\n          [\n            \"每个 TLS 握手消息都以一个 type 和一个 len 开始。\",\n            {\n              \"Tag\": \"ul\",\n              \"children\": [\n                {\n                  \"Tag\": \"li\",\n                  \"content\": \"14 - 握手消息类型 0x14 (finished)\"\n                },\n                {\n                  \"Tag\": \"li\",\n                  \"content\": \"00 00 20 - 紧接着的验证数据的长度 0x20 (32) 字节\"\n                }\n              ]\n            }\n          ]\n        ],\n        [\n          \"验证数据\",\n          {\n            \"props\": {\n              \"className\": \"bytes\"\n            },\n            \"content\": \"50 ff b0 c1 a4 25 c6 41 89 1c 98 3d 12 67 26 02 6d 3d b2 8e a3 51 0b dc 20 54 fc d6 37 ed ca cc\"\n          },\n          [\n            \"使用 \\\"客户端生成握手密钥\\\" 步骤中的客户端握手时密钥和在这之前的每个握手数据包(ClientHello 到 服务器握手完成)的 SHA256 哈希值生成。\",\n            {\n              \"Tag\": \"pre\",\n              \"children\": [\n                {\n                  \"Tag\": \"code\",\n                  \"props\": { \"className\": \"longboi\" },\n                  \"content\": \"finished_key = HKDF-Expand-Label(key: client_secret, label: \\\"finished\\\", ctx: \\\"\\\", len: 32)\\nfinished_hash = SHA256(ClientHello ... ServerFinished)\\nverify_data = HMAC-SHA256(key: finished_key, msg: finished_hash)\"\n                }\n              ]\n            },\n            {\n              \"children\": [\n                \"在命令行中使用\",\n                {\n                  \"Tag\": \"a\",\n                  \"props\": { \"href\": \"https://quic.xargs.org/files/hkdf.sh\" },\n                  \"content\": \"原作者制作的 HKDF 命令行脚本\"\n                },\n                \"，你也可以自己试试：\"\n              ]\n            },\n            {\n              \"Tag\": \"CodeSample\",\n              \"props\": {\n                \"code\": \"### find the hash of the conversation to this point, excluding\\n### QUIC frame headers\\n$ fin_hash=$(cat crypto_clienthello crypto_serverhello crypto_extensions   crypto_cert crypto_certverify crypto_s_finished | openssl sha256)\\n$ cht_secret=b8902ab5f9fe52fdec3aea54e9293e4b8eabf955fcd88536bf44b8b584f14982\\n$ fin_key=$(./hkdf expandlabel $cht_secret \\\"finished\\\" \\\"\\\" 32)\\n$ echo $fin_hash | xxd -r -p     | openssl dgst -sha256 -mac HMAC -macopt hexkey:$fin_key\\n\\n50ffb0c1a425c641891c983d126726026d3db28ea3510bdc2054fcd637edcacc\"\n              }\n            }\n          ]\n        ]\n      ]\n    }\n  }\n]\n"],"names":["module","exports","JSON","parse"],"version":3,"file":"clientTLSHandshakeFinished.5457064f.js.map"}